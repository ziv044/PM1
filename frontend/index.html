<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PM1 Agent Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-gray-800 text-white flex flex-col">
            <div class="p-4 border-b border-gray-700">
                <h1 class="text-xl font-bold">PM1 Admin</h1>
            </div>

            <div class="p-4">
                <button id="addAgentBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded flex items-center justify-center gap-2">
                    <span>+</span> Add Agent
                </button>
            </div>

            <div class="flex-1 overflow-y-auto p-4">
                <h2 class="text-sm uppercase text-gray-400 mb-2">Agents</h2>
                <div id="agentList" class="space-y-2">
                    <!-- Agent cards will be rendered here -->
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="bg-white shadow px-6 py-4 flex items-center justify-between">
                <h2 id="agentTitle" class="text-xl font-semibold text-gray-800">Select an Agent</h2>
                <div id="agentActions" class="hidden space-x-2">
                    <button id="editAgentBtn" class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded text-sm">Edit</button>
                    <button id="deleteAgentBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded text-sm">Delete</button>
                </div>
            </header>

            <!-- Tabs -->
            <div id="tabsContainer" class="hidden bg-white border-b px-6">
                <nav class="flex space-x-4">
                    <button class="tab-btn px-4 py-3 text-gray-600 hover:text-blue-600 border-b-2 border-transparent" data-tab="details">Details</button>
                    <button class="tab-btn px-4 py-3 text-gray-600 hover:text-blue-600 border-b-2 border-transparent" data-tab="skills">Skills</button>
                    <button class="tab-btn px-4 py-3 text-gray-600 hover:text-blue-600 border-b-2 border-transparent" data-tab="memory">Memory</button>
                    <button class="tab-btn px-4 py-3 text-gray-600 hover:text-blue-600 border-b-2 border-transparent" data-tab="chat">Chat</button>
                    <button class="tab-btn px-4 py-3 text-gray-600 hover:text-blue-600 border-b-2 border-transparent" data-tab="simulation">Simulation</button>
                    <button class="tab-btn px-4 py-3 text-gray-600 hover:text-blue-600 border-b-2 border-transparent" data-tab="logs">Logs</button>
                </nav>
            </div>

            <!-- Tab Content -->
            <div class="flex-1 overflow-y-auto p-6">
                <!-- Empty State -->
                <div id="emptyState" class="flex items-center justify-center h-full text-gray-400">
                    <div class="text-center">
                        <svg class="mx-auto h-16 w-16 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                        <p>Select an agent or create a new one</p>
                    </div>
                </div>

                <!-- Details Tab -->
                <div id="detailsTab" class="tab-content hidden">
                    <div class="bg-white rounded-lg shadow p-6 max-w-2xl">
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Agent ID</label>
                            <p id="detailAgentId" class="text-gray-900 font-mono bg-gray-100 p-2 rounded"></p>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Model</label>
                            <p id="detailModel" class="text-gray-900 bg-gray-100 p-2 rounded"></p>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">System Prompt</label>
                            <pre id="detailSystemPrompt" class="text-gray-900 bg-gray-100 p-4 rounded whitespace-pre-wrap text-sm max-h-64 overflow-y-auto"></pre>
                        </div>

                        <!-- Simulation Properties Display -->
                        <div class="border-t pt-4 mt-4">
                            <h4 class="font-medium text-gray-700 mb-3">Simulation Properties</h4>

                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Entity Type</label>
                                    <p id="detailEntityType" class="text-gray-900 bg-gray-100 p-2 rounded"></p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Event Frequency (min)</label>
                                    <p id="detailEventFrequency" class="text-gray-900 bg-gray-100 p-2 rounded"></p>
                                </div>
                            </div>

                            <div class="flex gap-4 mb-4">
                                <label class="flex items-center">
                                    <input type="checkbox" id="detailIsEnemy" disabled class="mr-2">
                                    <span class="text-sm text-gray-700">Is Enemy</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="detailIsWest" disabled class="mr-2">
                                    <span class="text-sm text-gray-700">Is West</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="detailIsEvilAxis" disabled class="mr-2">
                                    <span class="text-sm text-gray-700">Is Evil Axis</span>
                                </label>
                            </div>

                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Agenda</label>
                                <pre id="detailAgenda" class="text-gray-900 bg-gray-100 p-4 rounded whitespace-pre-wrap text-sm max-h-32 overflow-y-auto"></pre>
                            </div>

                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Primary Objectives</label>
                                <pre id="detailPrimaryObjectives" class="text-gray-900 bg-gray-100 p-4 rounded whitespace-pre-wrap text-sm max-h-32 overflow-y-auto"></pre>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Hard Rules</label>
                                <pre id="detailHardRules" class="text-gray-900 bg-gray-100 p-4 rounded whitespace-pre-wrap text-sm max-h-32 overflow-y-auto"></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Skills Tab -->
                <div id="skillsTab" class="tab-content hidden">
                    <div class="bg-white rounded-lg shadow p-6 max-w-2xl">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium">Skills</h3>
                            <button id="addSkillBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm">+ Add Skill</button>
                        </div>
                        <div id="skillsList" class="space-y-2">
                            <!-- Skills will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Memory Tab -->
                <div id="memoryTab" class="tab-content hidden">
                    <div class="bg-white rounded-lg shadow p-6 max-w-2xl">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium">Memory</h3>
                            <button id="addMemoryBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm">+ Add Memory</button>
                        </div>
                        <div id="memoryList" class="space-y-2">
                            <!-- Memory items will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Chat Tab -->
                <div id="chatTab" class="tab-content hidden h-full flex flex-col">
                    <div class="bg-white rounded-lg shadow flex-1 flex flex-col max-w-3xl">
                        <div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-4">
                            <!-- Chat messages will be rendered here -->
                        </div>
                        <div class="border-t p-4">
                            <div class="flex gap-2">
                                <input type="text" id="chatInput" placeholder="Type a message..."
                                    class="flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <button id="sendChatBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">Send</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Simulation Tab -->
                <div id="simulationTab" class="tab-content hidden">
                    <div class="bg-white rounded-lg shadow p-6 max-w-3xl">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-lg font-medium">Simulation Control</h3>
                            <div class="flex gap-2">
                                <button id="startSimBtn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">
                                    Start
                                </button>
                                <button id="stopSimBtn" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded" disabled>
                                    Stop
                                </button>
                            </div>
                        </div>

                        <!-- Status Panel -->
                        <div class="bg-gray-100 p-4 rounded mb-6">
                            <div class="grid grid-cols-4 gap-4">
                                <div>
                                    <span class="text-sm text-gray-500">Status</span>
                                    <p id="simStatus" class="font-medium text-red-600">Stopped</p>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-500">Game Clock</span>
                                    <p id="simClock" class="font-mono">--</p>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-500">Entities</span>
                                    <p id="simEntityCount" class="font-medium">0</p>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-500">Clock Speed</span>
                                    <div class="flex items-center gap-2">
                                        <input type="number" id="clockSpeedInput" value="2" min="0.1" max="60" step="0.1"
                                            class="w-16 border rounded px-2 py-1 text-sm">
                                        <span class="text-xs text-gray-600">sec/min</span>
                                        <button id="updateClockSpeedBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs">Set</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Event Log -->
                        <div>
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-medium">Event Log</h4>
                                <div class="flex gap-2">
                                    <span id="eventCount" class="text-sm text-gray-500">0 events</span>
                                    <button id="refreshEventsBtn" class="text-blue-600 hover:text-blue-700 text-sm">
                                        Refresh
                                    </button>
                                </div>
                            </div>
                            <div id="eventLog" class="bg-gray-900 text-green-400 p-4 rounded font-mono text-xs max-h-96 overflow-y-auto">
                                <p class="text-gray-500">No events yet. Start the simulation to generate events.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Logs Tab -->
                <div id="logsTab" class="tab-content hidden">
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium">Application Logs</h3>
                            <button id="refreshLogsBtn" class="bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded text-sm">Refresh</button>
                        </div>
                        <pre id="logsContent" class="bg-gray-900 text-green-400 p-4 rounded font-mono text-xs overflow-x-auto max-h-96 overflow-y-auto"></pre>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add/Edit Agent Modal -->
    <div id="agentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
            <div class="p-6">
                <h3 id="modalTitle" class="text-lg font-semibold mb-4">Add Agent</h3>
                <form id="agentForm">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Agent ID</label>
                        <input type="text" id="formAgentId" required
                            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Model</label>
                        <select id="formModel" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="claude-sonnet-4-20250514">Claude Sonnet 4</option>
                            <option value="claude-opus-4-20250514">Claude Opus 4</option>
                            <option value="claude-3-5-sonnet-20241022">Claude 3.5 Sonnet</option>
                            <option value="claude-3-5-haiku-20241022">Claude 3.5 Haiku</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">System Prompt</label>
                        <textarea id="formSystemPrompt" rows="4"
                            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="You are a helpful assistant..."></textarea>
                    </div>

                    <!-- Simulation Properties -->
                    <div class="border-t pt-4 mt-4">
                        <h4 class="font-medium text-gray-700 mb-3">Simulation Properties</h4>

                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Entity Type</label>
                                <select id="formEntityType" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="System">System</option>
                                    <option value="Entity">Entity</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Event Frequency (minutes)</label>
                                <input type="number" id="formEventFrequency" value="60" min="1"
                                    class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>

                        <div class="flex gap-4 mb-4">
                            <label class="flex items-center">
                                <input type="checkbox" id="formIsEnemy" class="mr-2">
                                <span class="text-sm text-gray-700">Is Enemy</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="formIsWest" class="mr-2">
                                <span class="text-sm text-gray-700">Is West</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="formIsEvilAxis" class="mr-2">
                                <span class="text-sm text-gray-700">Is Evil Axis</span>
                            </label>
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Agenda</label>
                            <textarea id="formAgenda" rows="2"
                                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                placeholder="Agent's overall agenda..."></textarea>
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Primary Objectives</label>
                            <textarea id="formPrimaryObjectives" rows="3"
                                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                placeholder="1. First objective&#10;2. Second objective"></textarea>
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Hard Rules</label>
                            <textarea id="formHardRules" rows="3"
                                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                placeholder="Constraints the agent must follow..."></textarea>
                        </div>
                    </div>

                    <div class="flex justify-end gap-2">
                        <button type="button" id="cancelModalBtn" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Skill Modal -->
    <div id="skillModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
            <div class="p-6">
                <h3 class="text-lg font-semibold mb-4">Add Skill</h3>
                <form id="skillForm">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Skill Name</label>
                        <input type="text" id="formSkill" required
                            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="e.g., code_generation">
                    </div>
                    <div class="flex justify-end gap-2">
                        <button type="button" id="cancelSkillBtn" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded">Add</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Memory Modal -->
    <div id="memoryModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
            <div class="p-6">
                <h3 class="text-lg font-semibold mb-4">Add Memory</h3>
                <form id="memoryForm">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Memory Item</label>
                        <textarea id="formMemory" rows="3" required
                            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Enter memory context..."></textarea>
                    </div>
                    <div class="flex justify-end gap-2">
                        <button type="button" id="cancelMemoryBtn" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded">Add</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-sm mx-4">
            <div class="p-6">
                <h3 class="text-lg font-semibold mb-2">Delete Agent</h3>
                <p class="text-gray-600 mb-4">Are you sure you want to delete this agent? This action cannot be undone.</p>
                <div class="flex justify-end gap-2">
                    <button id="cancelDeleteBtn" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded">Cancel</button>
                    <button id="confirmDeleteBtn" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/components.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
